<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>Image Upload</title>
  </head>
  <body>
    <h1>Image Upload</h1>
    <form id="image-form" enctype="multipart/form-data">
      <label for="image-input">Select an image to upload:</label>
      <input type="file" id="image-input" name="image" accept="image/*" />
      <button type="submit">Upload</button>
    </form>
    <img id="imgbox" src="#" alt="image" />
  </body>
  <script>
    const imageForm = document.getElementById("image-form");
    const imageInput = document.getElementById("image-input");
    const imgbox = document.getElementById("imgbox");
    imageInput.addEventListener("change", () => {
      const file = imageInput.files[0];

      if (file) {
        const url = URL.createObjectURL(file);
        imgbox.src = url;
      }
    });
    // Listen for the 'submit' event on the form element
    imageForm.addEventListener("submit", (event) => {
      event.stopImmediatePropagation();
      // Create a new FormData object and add the selected file to it
      const formData = new FormData();

      formData.append("image", imageInput.files[0]);
      // Make a POST request to the server with the FormData object as the request body
      var requestOptions = {
        method: "POST",
        body: formData,
        redirect: "follow",
      };

      fetch("http://localhost:3035/readpan", requestOptions)
        .then((response) => response.json())
        .then((result) => console.log("Task Completed"))
        .catch((error) => {
          console.log("Task not Completed");
          console.log("error", error);
        });
    });
  </script>
</html>
